(window.webpackJsonp=window.webpackJsonp||[]).push([[10,362],{1079:function(e,t,r){"use strict";var n=r(845),o={components:{Spinner:r.n(n).a},props:{bg:{type:String,default:"white"},isLoading:Boolean}},c=r(12),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isLoading?r("div",{staticClass:"absolute w-full h-full inset-0 flex items-center justify-center bg-opacity-50 z-1000",class:"bg-"+e.bg},[r("Spinner",{staticClass:"w-8 h-8 fill-current"})],1):e._e()}),[],!1,null,"af34215c",null);t.a=component.exports},1158:function(e,t,r){"use strict";(function(e){r(16),r(15),r(13),r(17),r(18);var n=r(1),o=r(4),c=(r(19),r(186),r(46),r(1175)),l=r(1075),d=r(302),f=r(28),m=r(284),v=r(14),h=r(1079),w=r(142);function _(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function y(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a={components:{Watermark:m.a,SpinnerLoader:h.a},props:{templateId:{type:String,default:null},iconId:{type:String,default:null},palette:{type:Object,default:null},logo:{type:Object,required:!0},shape:{type:String,default:null},updateKey:{type:Number,default:0},disablePreferenceMode:{type:Boolean,default:!0},mainPreview:{type:Boolean,default:!1},enableTextCasing:{type:Boolean,default:!1}},data:function(){return{logo_rendered:!1,render_time:null,logo_input:null,svgjsroot:null,finished_logo:null,background:null,unmounted:!1}},computed:y(y({},Object(f.e)(["editor","session","icons"])),Object(f.c)({getBinary:"fonts/getBinary"})),watch:{updateKey:function(){this.svgjsroot&&this.logo_rendered&&this.refreshLogo()}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.mainPreview&&v.a.$on(v.b.EditorRefreshLogo,e.refreshLogo),r=Object(l.a)(e.getSvgElement()),e.svgjsroot=r,t.next=5,e.createLogo();case 5:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.unmounted=!0,this.mainPreview&&v.a.$off(v.b.EditorRefreshLogo,this.refreshLogo)},methods:{getCanvasElement:function(){return this.$refs.canvas},getSvgElement:function(){return this.$refs.svg},sendRollbar:function(e){this.$rollbar.error("error creating editor logo",{error:e,props:{icon:this.iconId,template:this.templateId,palette:this.palette,logo:this.logo,shape:this.shape},logo_preset:this.editor.logo_preset,session:this.session})},createLogo:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.logo_rendered=!1,0!==e.editor.fonts.length){t.next=4;break}return t.next=4,e.$store.dispatch("editor/fetchFonts");case 4:return t.prev=4,t.next=7,e.invokeLogoDesignEngine(e.svgjsroot);case 7:t.next=14;break;case 9:t.prev=9,t.t0=t.catch(4),console.log("error creating logo ",t.t0),!e.unmounted&&e.svgjsroot&&e.getCanvasElement()&&e.sendRollbar(t.t0),e.$emit("failed");case 14:return t.prev=14,e.logo_rendered=!0,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[4,9,14,17]])})))()},refreshLogo:function(){var e=this.svgjsroot.first();e&&e.remove(),this.createLogo()},emitLogo:function(){if(this.logo_rendered&&this.logo){var e={logo:this.finished_logo,asset_data:{template:this.template}};this.$emit("logoselected",e)}},getFamilyByFontId:function(e){return this.editor.fonts.find((function(t){return t.variant_map.find((function(t){return t.id===e}))}))},getFontFromFamily:function(e,t){return e.variant_map.find((function(e){return e.id===t}))},getFont:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n=t.getFamilyByFontId(e))){r.next=5;break}return r.abrupt("return",t.getFontFromFamily(n,e));case 5:return r.next=7,t.$api.get("/api/v3/assets/fonts/".concat(e));case 7:return o=r.sent,data=o.data,r.abrupt("return",data);case 10:case"end":return r.stop()}}),r)})))()},getPalette:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("CUSTOM"!==e&&e){r.next=2;break}return r.abrupt("return",t.editor.logo_preset.palette_hex);case 2:if(!(n=t.editor.palettes.find((function(t){return t.id===e})))){r.next=5;break}return r.abrupt("return",n);case 5:return r.next=7,t.$api.get("/api/v3/assets/palettes/".concat(e));case 7:return o=r.sent,data=o.data,r.abrupt("return",data);case 10:case"end":return r.stop()}}),r)})))()},getIcon:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n=t.icons.icons.find((function(t){return t.id===e})))){r.next=3;break}return r.abrupt("return",n);case 3:return r.abrupt("return",t.$store.dispatch("icons/getIcon",e));case 4:case"end":return r.stop()}}),r)})))()},getTemplate:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var template,n,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(template=t.editor.templates.find((function(template){return template.id===e}))){r.next=7;break}return r.next=4,t.$api.get("/api/v3/assets/templates/".concat(e));case 4:return n=r.sent,data=n.data,r.abrupt("return",data);case 7:return r.abrupt("return",template);case 8:case"end":return r.stop()}}),r)})))()},invokeLogoDesignEngine:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,l,f,m,v,h,_,y,x,k,O,j,template,P,C,S,R,F,L,$,B,E,M,D,I,T;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(m=t.getCanvasElement(),r.prev=1,m.getContext("2d")){r.next=5;break}throw"Error: Canvas not mounted";case 5:r.next=12;break;case 7:return r.prev=7,r.t0=r.catch(1),console.log("canvas not mounted, cannot proceed"),t.$emit("failed"),r.abrupt("return");case 12:return v=t.editor,h=v.logo_preset.wordmark_fonts,r.next=16,t.getFont(h);case 16:return _=r.sent,r.next=19,t.loadFontBinary(_);case 19:if(y=r.sent,x=v.logo_preset.palettes,null===(n=t.palette)||void 0===n){r.next=25;break}r.t1=n,r.next=28;break;case 25:return r.next=27,t.getPalette(x);case 27:r.t1=r.sent;case 28:return k=r.t1,O=JSON.parse(JSON.stringify(k)),t.background=O.background,j=null!==(o=t.templateId)&&void 0!==o?o:v.logo_preset.templates,r.next=34,t.getTemplate(j);case 34:if(template=r.sent,P={wordmark_fonts:[y],palettes:[O],templates:[template]},!(C=v.logo_preset.slogan_fonts)){r.next=47;break}return r.next=40,t.getFont(C);case 40:return S=r.sent,r.next=43,t.loadFontBinary(S);case 43:R=r.sent,P.slogan_fonts=[R],r.next=52;break;case 47:if(!t.session.slogan){r.next=52;break}return r.next=50,t.loadFontBinary(t.editor.fonts[0].variant_map[0]);case 50:F=r.sent,P.slogan_fonts=[F];case 52:if(L=null!==(l=t.iconId)&&void 0!==l?l:v.logo_preset.icons,$={ids:[]},!L){r.next=60;break}return r.next=57,t.getIcon(L);case 57:B=r.sent,P.icons=[B],$.ids.push(L);case 60:return E=new c.b([template],P),M={amount:1,brand:{wordmark:t.session.wordmark,slogan:t.session.slogan,raw_keywords:["hello"]},presets:{templates:{ids:[j]},palettes:{ids:[O.id]},wordmark_fonts:{ids:[h]},slogan_fonts:{ids:[C]},icons:$},style:{enable_text_casing:t.enableTextCasing,disable_preference_mode:t.disablePreferenceMode,icon_orientation:t.disablePreferenceMode?v.icon_orientation:"default",icon_scale:v.icon_scale,slogan_scale:v.slogan_scale,slogan_alignment:t.disablePreferenceMode?v.slogan_alignment:"default",wordmark_alignment:t.disablePreferenceMode?v.wordmark_alignment:"default",slogan_multiline:t.disablePreferenceMode?v.slogan_multiline:"default",slogan_multicolor:t.disablePreferenceMode?v.slogan_multicolor:"default",wordmark_multiline:t.disablePreferenceMode?v.wordmark_multiline:"default",wordmark_multicolor:t.disablePreferenceMode?v.wordmark_multicolor:"default",shape_container:t.disablePreferenceMode?null!==(f=t.shape)&&void 0!==f?f:v.shape:"default",template_alignment:t.disablePreferenceMode?v.template_alignment:"default"},controls:{icon_page:1},inkscape:!1,svgjs:e,canvasdom:m,resources:E},r.next=64,d.logos.create(M);case 64:if(D=r.sent,t.finished_logo=D[0],!t.mainPreview){r.next=75;break}try{Object(w.a)(e)}catch(e){}return r.next=70,t.$store.dispatch("editor/addClientLogoToState",{logo:t.finished_logo});case 70:if(!(I=t.svgjsroot.findOne("#tight-bounds"))){r.next=75;break}return T=I.svg(),r.next=75,t.$store.commit("editor/SET_TIGHT_BOUNDS",T);case 75:case"end":return r.stop()}}),r,null,[[1,7]])})))()},loadFontBinary:function(t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){var o,c,l,d,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.cdn_url,c=t.id,!(l=r.getBinary(c))){n.next=6;break}return n.abrupt("return",y(y({},t),{},{file:e.from(l)}));case 6:return n.next=8,r.$api.get(o,{responseType:"arraybuffer"});case 8:return d=n.sent,f=e.from(d.data),r.$store.commit("fonts/addFontBinary",{id:c,buffer:f}),n.abrupt("return",y(y({},t),{},{file:f}));case 12:case"end":return n.stop()}}),n)})))()}}}}).call(this,r(25).Buffer)},1175:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r(305),o=r(306);function c(e,t){var r={};return r.assets=t,r.templates=e,r.loadAll=function(e){return this.assets},r.load=function(e){return this.templates},r}var l=function(){function e(t,r){Object(n.a)(this,e),this.templates=void 0,this.asssets=void 0,this.templates=t,this.assets=r}return Object(o.a)(e,[{key:"loadAll",value:function(e){return this.assets}},{key:"load",value:function(e){return this.templates}}]),e}()},1211:function(e,t,r){var content=r(1249);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(86).default)("d8c53e9e",content,!0,{sourceMap:!1})},1230:function(e,t,r){"use strict";var n=r(1158).a,o=(r(1248),r(12)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"relative overflow-hidden rounded shadow-lg overlay",on:{click:function(t){return e.emitLogo()}}},[r("canvas",{ref:"canvas",attrs:{width:"1",height:"1"}}),e._v(" "),r("div",{staticClass:"logo-preview w-full"},[r("Transition",[e.mainPreview&&!e.logo_rendered?r("div",{staticClass:"absolute w-full h-full z-1000 p-auto",style:{background:e.background},on:{click:function(t){return e.emitLogo()}}},[r("SpinnerLoader",{attrs:{"is-loading":!0}})],1):e._e()]),e._v(" "),e.logo_rendered?r("Watermark",{staticClass:"w-full h-full",attrs:{background:e.background}}):e._e(),e._v(" "),r("svg",{ref:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:svgjs":"http://svgjs.com/svgjs",viewBox:"0 0 640 400"}})],1)])}),[],!1,null,null,null);t.a=component.exports},1248:function(e,t,r){"use strict";r(1211)},1249:function(e,t,r){var n=r(85)((function(i){return i[1]}));n.push([e.i,".logo-preview svg{width:100%;height:auto}.v-enter-active,.v-leave-active{transition:opacity .1s ease}.v-enter-from,.v-leave-to{opacity:0}.preview-svg svg{border-radius:.25rem;width:91.666667%}.logo-element-hover-target{cursor:pointer;stroke-width:2;fill:transparent}.overlay:hover .logo-element-hover-target{--text-opacity:1;color:#d2d6dc;color:rgba(210,214,220,var(--text-opacity));stroke:currentColor;opacity:.25}.logo-element-hover-target:hover{color:var(--color-enterprise-primary,#1890ff)!important;stroke:currentColor!important;opacity:1!important}",""]),n.locals={},e.exports=n},845:function(e,t,r){r(16),r(15),r(13),r(17),r(18);var n=r(38),o=r(39),c=["class","staticClass","style","staticStyle","attrs"];function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}e.exports={functional:!0,render:function(e,t){var r=t._c,data=(t._v,t.data),d=t.children,f=void 0===d?[]:d,m=data.class,v=data.staticClass,style=data.style,h=data.staticStyle,w=data.attrs,_=void 0===w?{}:w,y=o(data,c);return r("svg",function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){n(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({class:[m,v],style:[style,h],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",fill:"currentColor",version:"1.0",width:"64",height:"64",viewBox:"0 0 128 128"},_)},y),f.concat([r("g",[r("path",{attrs:{d:"M75.4 126.63a11.43 11.43 0 01-2.1-22.65 40.9 40.9 0 0030.5-30.6 11.4 11.4 0 1122.27 4.87h.02a63.77 63.77 0 01-47.8 48.05v-.02a11.38 11.38 0 01-2.93.37z"}}),r("animateTransform",{attrs:{attributeName:"transform",type:"rotate",from:"0 64 64",to:"360 64 64",dur:"1000ms",repeatCount:"indefinite"}})])]))}}}}]);